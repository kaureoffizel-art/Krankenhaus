<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Prof. Dr. Kenan Privatklinik</title>
<style>
body {margin:0;font-family:'Segoe UI',sans-serif;background:#f0f4f8;color:#1e1e2f;}
header {background:#3498db;color:white;padding:20px;font-size:24px;text-align:center;position:fixed;top:0;width:100%;z-index:10;}
.sidebar {position:fixed;top:70px;left:0;width:220px;background:#1e3d59;height:100%;padding-top:20px;}
.sidebar a {display:block;color:white;padding:12px;text-decoration:none;margin-bottom:5px;border-radius:6px;cursor:pointer;}
.sidebar a:hover {background:#3b5c7c;}
.main {margin-left:240px;padding:90px 20px 20px 20px;}
.card {background:white;padding:20px;margin-bottom:20px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.1);display:none;}
.card.active {display:block;}
input, textarea, select, button {width:100%;padding:10px;margin-bottom:10px;border-radius:6px;border:1px solid #ccc;font-size:14px;}
button {background:#3498db;color:white;border:none;cursor:pointer;}
button.danger {background:#e74c3c;}
table {width:100%;border-collapse:collapse;margin-top:10px;}
th, td {border:1px solid #ddd;padding:10px;text-align:left;}
th {background:#1e3d59;color:white;}
#qr {margin-top:10px;}
@media(max-width:768px){.sidebar{width:100%;height:auto;position:relative;}.main{margin-left:0;padding-top:140px;}}
</style>
</head>
<body>

<header>üè• Prof. Dr. Kenan Privatklinik</header>

<div class="sidebar">
<a onclick="showSection('dashboard')">Dashboard</a>
<a onclick="showSection('patients')">Patienten</a>
<a onclick="showSection('calendar')">Kalender</a>
<a onclick="showSection('admin')">Admin</a>
</div>

<div class="main">

<!-- Dashboard -->
<div id="dashboard" class="card active">
<h2>Dashboard</h2>
<p>Gesamt Patienten: <span id="totalPatients">0</span></p>
<p>Notf√§lle: <span id="emergencies">0</span></p>
</div>

<!-- Patientenverwaltung -->
<div id="patients" class="card">
<h2>Patientenverwaltung</h2>
<h3>Neuen Patienten hinzuf√ºgen</h3>
<input placeholder="Name" id="pName">
<input type="date" placeholder="Geburtsdatum" id="pDOB">
<input placeholder="Adresse" id="pAddress">
<input placeholder="Telefonnummer" id="pPhone">
<input placeholder="Versicherungsnummer" id="pInsurance">
<textarea placeholder="Notizen" id="pNotes"></textarea>
<select id="pStatus">
<option>Wartend</option>
<option>In Behandlung</option>
<option>Abgeschlossen</option>
</select>
<select id="pUrgency">
<option value="1">Dringlichkeit 1 (h√∂chste)</option>
<option value="2">Dringlichkeit 2</option>
<option value="3">Dringlichkeit 3</option>
<option value="4">Dringlichkeit 4 (niedrig)</option>
</select>
<button onclick="addPatient()">Patient speichern</button>
<button class="danger" onclick="emergency()">SCHNELL BEHANDELN</button>
<input placeholder="Suche Patienten" id="search" oninput="updatePatients()">
<div id="qr"></div>

<h3>Patientenliste</h3>
<table>
<thead><tr><th>Name</th><th>Status</th><th>Dringlichkeit</th><th>Aktionen</th></tr></thead>
<tbody id="patientTable"></tbody>
</table>
</div>

<!-- Kalender -->
<div id="calendar" class="card">
<h2>Kalender (√úbersicht)</h2>
<table>
<thead><tr><th>Datum</th><th>Uhrzeit</th><th>Patient</th><th>Arzt</th></tr></thead>
<tbody id="calendarTable"></tbody>
</table>
</div>

<!-- Admin Panel -->
<div id="admin" class="card">
<h2>Admin-Panel</h2>
<input placeholder="Benutzername" id="uName">
<input placeholder="Passwort" id="uPass">
<select id="uRole">
<option>Admin</option>
<option>Arzt</option>
<option>Empfang</option>
</select>
<button onclick="addUser()">Benutzer erstellen</button>

<h3>Benutzerliste</h3>
<ul id="userList"></ul>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script>
let patients = [];
let users = [{username:'Admin', password:'admin', role:'Admin'}];

function showSection(id){
  document.querySelectorAll('.card').forEach(c=>c.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// Patientenfunktionen
function addPatient(){
  let patient = {
    name: document.getElementById('pName').value,
    dob: document.getElementById('pDOB').value,
    address: document.getElementById('pAddress').value,
    phone: document.getElementById('pPhone').value,
    insurance: document.getElementById('pInsurance').value,
    notes: document.getElementById('pNotes').value,
    status: document.getElementById('pStatus').value,
    urgency: document.getElementById('pUrgency').value
  };
  patients.push(patient);
  document.getElementById('pName').value=''; document.getElementById('pDOB').value='';
  document.getElementById('pAddress').value=''; document.getElementById('pPhone').value='';
  document.getElementById('pInsurance').value=''; document.getElementById('pNotes').value='';
  updatePatients();
  generateQR(patient);
}

function emergency(){
  if(patients.length>0){
    patients[patients.length-1].urgency=1;
    updatePatients();
    alert('Patient auf h√∂chste Dringlichkeit gesetzt!');
  }
}

function updatePatients(){
  let tbody = document.getElementById('patientTable');
  tbody.innerHTML='';
  let search = document.getElementById('search').value.toLowerCase();
  let emergencies = 0;
  patients.forEach((p,i)=>{
    if(p.urgency==1) emergencies++;
    if(p.name.toLowerCase().includes(search)){
      tbody.innerHTML += `<tr>
        <td>${p.name}</td>
        <td>${p.status}</td>
        <td>${p.urgency}</td>
        <td>
          <button onclick="generatePDF(${i})">PDF</button>
        </td>
      </tr>`;
    }
  });
  document.getElementById('totalPatients').textContent = patients.length;
  document.getElementById('emergencies').textContent = emergencies;
  updateCalendar();
}

function updateCalendar(){
  let tbody = document.getElementById('calendarTable');
  tbody.innerHTML='';
  patients.forEach(p=>{
    tbody.innerHTML += `<tr>
      <td>${p.dob}</td>
      <td>10:00</td>
      <td>${p.name}</td>
      <td>Dr. Kenan</td>
    </tr>`;
  });
}

// Adminfunktionen
function addUser(){
  let user = {
    username: document.getElementById('uName').value,
    password: document.getElementById('uPass').value,
    role: document.getElementById('uRole').value
  };
  users.push(user);
  document.getElementById('uName').value=''; document.getElementById('uPass').value='';
  updateUsers();
}

function updateUsers(){
  let ul = document.getElementById('userList');
  ul.innerHTML='';
  users.forEach((u,i)=>{
    ul.innerHTML += `<li>${u.username} (${u.role}) <button onclick="deleteUser(${i})">L√∂schen</button></li>`;
  });
}

function deleteUser(i){
  users.splice(i,1);
  updateUsers();
}

// PDF
function generatePDF(i){
  const { jsPDF } = window.jspdf;
  let doc = new jsPDF();
  let p = patients[i];
  doc.text(`Patientenakte ‚Äì ${p.name}`,20,20);
  doc.text(`Geburtsdatum: ${p.dob}`,20,30);
  doc.text(`Adresse: ${p.address}`,20,40);
  doc.text(`Telefon: ${p.phone}`,20,50);
  doc.text(`Versicherung: ${p.insurance}`,20,60);
  doc.text(`Status: ${p.status}`,20,70);
  doc.text(`Dringlichkeit: ${p.urgency}`,20,80);
  doc.text(`Notizen: ${p.notes}`,20,90);
  doc.save(`${p.name}_akte.pdf`);
}

// QR-Code
function generateQR(patient){
  document.getElementById('qr').innerHTML='';
  QRCode.toCanvas(document.getElementById('qr'), patient.name + ' | ' + patient.dob, function (error) {
    if (error) console.error(error)
  });
}
</script>

</body>
</html>
